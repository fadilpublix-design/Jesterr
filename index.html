<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>$Jester — XRP Meme Project</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700;900&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="navbar">
    <div class="nav-left">
      <img src="karakter.png" alt="Jester Logo" class="logo">
      <span class="brand">$JESTER</span>
    </div>

    <nav class="nav-center" role="navigation" aria-label="Main">
      <a href="#about">{ABOUT}</a>
      <a href="#memes">{MEMES}</a>
      <a href="#members">{MEMBERS}</a>
      <a href="#learn">{LEARN}</a>
    </nav>

    <div class="nav-right">
      <a href="#"><img src="first ledger.png" alt="logo 1" class="nav-logo"></a>
      <a href="#"><img src="telegram.png" alt="Logo 2" class="nav-logo"></a>
      <a href="#"><img src="xrp.cafe.png" alt="Logo 3" class="nav-logo"></a>
      <a href="#"><img src="logo-xcom-640x640-removebg-preview (1).png" alt="Logo 4" class="nav-logo"></a>

      <button id="menu-toggle" class="menu-toggle" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-menu">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </button>
    </div>

    <div id="mobile-menu" class="mobile-menu" role="menu" aria-hidden="true">
      <a href="#about" role="menuitem">{ABOUT}</a>
      <a href="#memes" role="menuitem">{MEMES}</a>
      <a href="#members" role="menuitem">{MEMBERS}</a>
      <a href="#learn" role="menuitem">{LEARN}</a>
    </div>
  </header>

  <main class="hero">
    <svg id="svg-root" viewBox="0 0 860 300" class="curved-text" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
      <path id="curve-top" d="M 90 180 Q 430 20 770 180" fill="transparent" />
      <text>
        <textPath xlink:href="#curve-top" startOffset="50%" text-anchor="middle" class="main-text">JESTER</textPath>
      </text>

      <path id="curve-bottom" d="M 200 220 Q 400 100 660 220" fill="transparent" />
      <text>
        <textPath xlink:href="#curve-bottom" startOffset="50%" text-anchor="middle" class="subtext" id="subtext-path">
          <tspan class="on" dy="5" letter-spacing="5">ON</tspan>
          <tspan class="spacer" dx="15"></tspan>
          <tspan class="after" dx="90" letter-spacing="5" baseline-shift="7%">XRP LEDGER</tspan>
        </textPath>
      </text>

      <image id="x-img" href="a254c20c-50ee-42df-8de6-95c75bbdb695-removebg-preview.png" width="95" height="95" x="10" y="10" preserveAspectRatio="xMidYMid meet"></image>
    </svg>

    <div><img src="karakter.png" alt="Karakter Jester" class="karakter"></div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      <div class="footer-title">$Jester</div>
      <nav class="footer-links" aria-label="Footer links">
        <a href="#terms" class="footer-link">TERMS OF USE</a>
        <span class="dot">·</span>
        <a href="#privacy" class="footer-link">PRIVACY POLICY</a>
      </nav>
      <div class="footer-copy">© 2025 Jester — All Rights Reserved</div>
    </div>
  </footer>

  <script>
  /* ---------------------------
     Header height helper (dynamic)
     --------------------------- */
  function updateHeaderHeight() {
    const nav = document.querySelector('.navbar');
    if (!nav) return;
    const h = Math.ceil(nav.getBoundingClientRect().height);
    document.documentElement.style.setProperty('--header-height', h + 'px');
  }

  /* ---------------------------
     placeXImageAndRotate (improved)
     - uses fixed viewBox coordinates so results match desktop & mobile
     - auto-scales icon if space is narrow
     --------------------------- */
  function placeXImageAndRotate() {
    const svg = document.getElementById('svg-root');
    if (!svg) return;
    const path = svg.querySelector('#curve-bottom');
    const onTspan = svg.querySelector('.on');
    const afterTspan = svg.querySelector('.after');
    const img = svg.querySelector('#x-img');
    if (!path || !onTspan || !afterTspan || !img) return;

    try {
      // compute boxes in SVG user-space
      const onBox = onTspan.getBBox();
      const afterBox = afterTspan.getBBox();

      const padding = 8;
      const onEndX = onBox.x + onBox.width + padding;
      const afterStartX = afterBox.x - padding;
      let centerX = (onEndX + afterStartX) / 2;

      // find closest point on path (sampling)
      const totalLen = path.getTotalLength();
      const samples = 360;
      let best = {d: Infinity, t: 0, pt: path.getPointAtLength(0)};
      for (let i = 0; i <= samples; i++) {
        const t = (i / samples) * totalLen;
        const pt = path.getPointAtLength(t);
        const diff = Math.abs(pt.x - centerX);
        if (diff < best.d) best = {d: diff, t, pt};
      }

      const target = best.pt;
      const tAt = best.t;

      // compute tangent for rotation
      const delta = Math.max(0.5, totalLen / samples);
      const p1 = path.getPointAtLength(Math.max(0, tAt - delta));
      const p2 = path.getPointAtLength(Math.min(totalLen, tAt + delta));
      const dx = p2.x - p1.x;
      const dy = p2.y - p1.y;
      let angleDeg = Math.atan2(dy, dx) * 180 / Math.PI;

      // image size (may be scaled down if space small)
      let imgW = Number(img.getAttribute('width')) || img.getBBox().width;
      let imgH = Number(img.getAttribute('height')) || img.getBBox().height;
      const available = Math.max(8, afterStartX - onEndX);

      // if icon wider than available, scale it down
      if (imgW > available) {
        const scale = Math.max(0.30, (available - 4) / imgW);
        imgW = Math.max(8, Math.round(imgW * scale));
        imgH = Math.max(8, Math.round(imgH * scale));
        img.setAttribute('width', imgW);
        img.setAttribute('height', imgH);
      }

      // fine tune vertical position (makes icon sit slightly above baseline)
      const fineTuneY = -4;
      let imgX = target.x - imgW / 2;
      let imgY = target.y - imgH / 2 + fineTuneY;

      // prevent overlap: nudge within [onEndX, afterStartX]
      const leftLimit = onEndX + 2;
      const rightLimit = afterStartX - 2;
      if (imgX < leftLimit) imgX = leftLimit;
      if (imgX + imgW > rightLimit) imgX = rightLimit - imgW;

      img.setAttribute('x', imgX);
      img.setAttribute('y', imgY);

      const cx = imgX + imgW / 2;
      const cy = imgY + imgH / 2;
      img.setAttribute('transform', `rotate(${angleDeg}, ${cx}, ${cy})`);
    } catch (err) {
      console.warn('SVG placement error:', err);
    }
  }

  /* run placement after fonts/layout ready */
  function runPlacementSequence() {
    updateHeaderHeight();
    // do a few passes to stabilize
    placeXImageAndRotate();
    setTimeout(placeXImageAndRotate, 120);
    setTimeout(placeXImageAndRotate, 300);
  }

  window.addEventListener('load', () => {
    runPlacementSequence();
  });

  window.addEventListener('resize', () => {
    clearTimeout(window._placeTimer);
    window._placeTimer = setTimeout(runPlacementSequence, 160);
    clearTimeout(window._hdrTimer);
    window._hdrTimer = setTimeout(updateHeaderHeight, 160);
  });

  window.addEventListener('orientationchange', () => {
    setTimeout(runPlacementSequence, 200);
  });

  /* ---------------------------
     Hamburger menu logic (calls placement & header update)
     --------------------------- */
  (function () {
    const toggle = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    if (!toggle || !mobileMenu) return;

    function openMenu() {
      toggle.setAttribute('aria-expanded', 'true');
      mobileMenu.classList.add('show');
      mobileMenu.setAttribute('aria-hidden', 'false');
      toggle.classList.add('active');
      // update layout & placement after open animation
      setTimeout(() => { updateHeaderHeight(); placeXImageAndRotate(); }, 220);
    }

    function closeMenu() {
      toggle.setAttribute('aria-expanded', 'false');
      mobileMenu.classList.remove('show');
      mobileMenu.setAttribute('aria-hidden', 'true');
      toggle.classList.remove('active');
      setTimeout(() => { updateHeaderHeight(); placeXImageAndRotate(); }, 120);
    }

    toggle.addEventListener('click', (e) => {
      e.stopPropagation();
      const open = toggle.classList.contains('active');
      if (open) closeMenu(); else openMenu();
    });

    // close if click outside
    document.addEventListener('click', (e) => {
      if (!mobileMenu.contains(e.target) && !toggle.contains(e.target)) {
        if (mobileMenu.classList.contains('show')) closeMenu();
      }
    });

    // keyboard: ESC closes
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeMenu(); });
  })();
  </script>
</body>
</html>
